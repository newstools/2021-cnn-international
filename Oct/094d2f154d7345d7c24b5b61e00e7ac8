New York (CNN Business)Amazon's rise has been relentless for more than a decade, with regulators and rivals alike failing to slow it. But now Amazon has taken a hit from a pair of immovable forces: snarled supply chains and worker shortages. The company's third-quarter earnings and sales fell well short of Wall Street's projections. It was a rare miss for Amazon that drove its stock down around 3% in mid-day trading Friday. Apple (AAPL) also said Thursday that chip shortages and manufacturing disruptions caused it to miss out on $6 billion in sales in the last quarter. Shoppers aren't what's holding Amazon back. The American economy remains strong, and demand for online shopping is growing — albeit at a slower rate than last year when stores were closed and everyone was stuck at home. The issue: Amazon just can't get all of its stuff to customers quickly enough. "This shows it's not regulators or competition slowing Amazon down, it's the supply chain nightmare," said Daniel Ives, a technology analyst at Wedbush Securities.  Amazon said supply chain bottlenecks and inflation on raw materials, labor and trucking costs crimped profits during its latest quarter. Those ongoing problems will cost the company an additional $4 billion this quarter, dragging down profits during the upcoming holiday shopping period, the company added. "We're dealing with labor risks and supply chain interruptions like many other companies," Amazon chief financial officer Brian Olsavsky said on a call with analysts Thursday. "Certainly, the cost of fulfillment in the last few months and what we've forecast into the next quarter are not what we're happy about." Olsavsky said staffing shortages at some warehouses during the last quarter forced it to reroute products to other facilities that that were fully staffed but less convenient. This resulted in "less optimal placement, which leads leads to longer and more expensive transportation routes." Amazon's results and the response from investors are fresh signs of the far-reaching impact of the supply chain crisis and hiring struggles. Small stores — without the scale to keep prices down in the face of elevated costs or the logistics networks to overcome supply shortages and delays — are getting hit hardest, say retail analysts. But these problems are plaguing corporate giants, too. On average, 15% to 23% of products are out of stock on Amazon's online marketplace, an all-time high, according to Guru Hariharan, who worked at Amazon's retail business for five years and runs CommerceIQ, an e-commerce analytics company that advises leading brands such as Kellogg, Colgate and Duracell selling on Amazon. CommerceIQ tracks out-of-stock rates from its range of clients on Amazon, which it then aggregates as a representative sample of a product category on the site. Amazon declined to comment on the data. The company ramped up promotions in October to push customers to shop early for the holidays. Pulling demand forward helps Amazon prevent a crush of orders later in the holiday that can strain its delivery operations.  "That works better for us than to have it all hit in a few concentrated weeks around Cyber Monday and Black Friday," Amazon's Olsavsky said Thursday. "Operationally, it's easier to perform when the volume is spread out." He added: "Love it in October, but we will take it in November and December as well." The company is also using more containers and bringing in goods to new US ports to dodge clogged entryways on the West Coast. On the labor side, Amazon is increasing wages and dangling sign-on bonuses to ease "inconsistent staffing levels in our operations," he said. Amazon is hiring 150,000 holiday workers to meet demand. Its starting average hourly wage is above $18, with an additional $3 an hour for certain shifts in some locations and signing bonuses up to $3,000. Despite the downbeat quarter and the challenges Amazon is facing, many analysts say it's still gaining market share from competitors and remains in a stronger position than rivals to weather ongoing supply and labor disruptions. The company has also spent heavily in recent years to build new warehouses and add capacity in an effort speed up delivery times. Analysts expect these investments to benefit Amazon in the long term. "We remain positive on [Amazon] in the longer term, and believe that supply chain issues and elevated shipping costs are temporary, not structural," James Lee, an analyst at Mizuho Securities, said in a note to clients Friday. —CNN Business' Clare Duffy contributed to this article. 