New York (CNN Business)CVS' announcement Thursday that it will close 900 stores over the next three years — around 10% of its pharmacies — may have caught some shoppers off guard. Isn't CVS doing really well right now? Haven't lots of people gone to drug stores during the pandemic to stock up on hand sanitizer, cleaning wipes and toilet paper? What about all those Covid-19 vaccine shots CVS gives out?  Actually, CVS' closures shouldn't come as a surprise. They are the latest moves in the long-running contraction of the US retail pharmacy sector. CVS (CVS), Walgreens (WBA) and Rite Aid (RAD) have been shuttering stores for years, while independent pharmacies have come under pressure from chains. Drug store closures can hurt local communities, creating access gaps for medications and essentials. CVS, the largest drug store chain in the United States, pointed to "changes in population, consumer buying patterns and future health needs" as factors in its decision to close stores. Here's why CVS will close 900 stores. Pivot to health care The future of CVS is not selling snacks, candy, shampoo and greeting cards. It's in health care. To that end, in 2018 CVS completed a $69 billion acquisition of Aetna, the largest health care deal in history, to create a gigantic customer base of about 40 million Americans. CVS bet that the deal will increase its profits from those patients' health plans while helping to lower its costs. CVS also has been revamping its retail strategy and said Thursday that its stores will have three distinct models: locations that offer primary care services; "HealthHub" stores that have on-site dieticians, nurse practitioners and lab services, and on-site treatment for chronic conditions such as diabetes and asthma; and traditional stores. CVS is "really pivoting and leaning into the health care aspects of the business," said George Hill, an analyst who covers the company and the health care industry at Deutsche Bank. "You'd much rather be selling health care services that are high-dollar value, high-margin versus greeting cards." Too many stores When you walk down the street or drive around the suburbs you'll typically pass a CVS. And then hit a Walgreens right next door. Rite Aid is probably pretty close, too. "There's too many pharmacies in the country and there's too much pharmacy capacity. That gives CVS a reason to go," said Hill.  CVS closed 244 stores between 2018 and 2020, yet it still has more than 9,900 stores. That's more than Walmart (WMT), Target (TGT) Kroger (KR) and Costco (COST) — combined. Its latest closings will "reduce store density in certain locations," CVS said Thursday, which translates into the fact that CVS has too many stores too close to each other in some places. Competition from Amazon and Dollar General Also, fewer people are heading to CVS and other drug stores to fill their prescriptions and shop for household staples these days. (And they're not going into CVS to buy tobacco, either, which the company stopped selling in 2014.) Some shoppers have replaced their trips to stores like CVS by buying their supplies online from Amazon (AMZN), or from brick-and-mortar giants like Walmart and Target. The chains have built their own strong e-commerce businesses in recent years. Dollar General (DG) has also grabbed market share from drug stores, undercutting the sector with lower prices on similar items. And now Dollar General is launching its own health care initiative as it continues to take business from pharmacies.  Online pharmacies and telemedicine have gained traction, too. Amazon bought PillPack in 2018 for more than $700 million and started shipping prescriptions to Prime members last year. Capsule and other digital pharmacies that deliver directly to customers' homes are also growing. Although brick-and-mortar pharmacies are still an important stop for many elderly people,or those who don't use the web or have access to it, they are increasingly becoming a thing of the past to the growing ranks of online shoppers. Rising costs Closing stores also reduces CVS' costs while still keeping most of its sales. Its labor and store operations costs increased during the pandemic because of safety protections like plexiglass, floor decals and masks. The company said in August it planned to raise its minimum wage to $15 an hour from $11 in a bid to retain and attract workers. "There are cost pressures in all directions," said Hill, the Deutsche Bank analyst. Seventy-five percent of CVS' sales comes from filling prescriptions, but its profits from that segment have declined in recent years because of lower reimbursement rates. But when CVS closes a store, it can hold onto most of those sales by shifting the prescriptions to its nearest pharmacies, Hill said. Covid-19 vaccines weren't a huge boost CVS got a lift from people coming into its stores for their Covid-19 vaccines and tests. The company has administered 43 million vaccines and around 38 million tests, CEO Karen Lynch said on an earnings call earlier this month. But the vaccines were only a short-term gain for the company, which said they will generate only $3 billion in revenue in 2021. That will decline by up to 40% next year, along with whatever sales CVS racked up as shoppers browsed aisles while they waited to get vaccinated, Lynch said. People also visited their doctors less frequently last year and into 2021, and elective procedures were suspended early in the pandemic, which meant that CVS filled fewer regular and chronic care prescriptions than in the years before the pandemic. And fewer people have also been coming into stores to pick up cough and fever medicines — big business for CVS — because they're still wearing masks and spending more time at home than they once did. 